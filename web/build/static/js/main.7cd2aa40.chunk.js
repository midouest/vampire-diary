(this.webpackJsonpweb=this.webpackJsonpweb||[]).push([[0],{110:function(e,t,r){},113:function(e,t,r){"use strict";r.r(t);r(94),r(95),r(96);var n=r(1),a=r.n(n),c=r(19),i=r.n(c),s=r(61),o=r(6),l=function(){return Object(s.b)()},u=s.c,d=r(118),j=r(129),b=r(65),h=r(92),m=r(7),p=r(8),x=r.n(p),O=r(13),f=r(10),v=r(2);function y(e){return function(t,r){var n,a=null!==r&&void 0!==r?r:{};return a.headers=Object(v.a)(Object(v.a)({},e),null!==(n=a.headers)&&void 0!==n?n:{}),fetch(t,a)}}function g(e,t){return k.apply(this,arguments)}function k(){return(k=Object(O.a)(x.a.mark((function e(t,r){var n,a;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t("/api/v1/auth/login/",{method:"POST",body:JSON.stringify(r)});case 2:return n=e.sent,e.next=5,n.json();case 5:if(a=e.sent,n.ok){e.next=8;break}throw new Error(a);case 8:return e.abrupt("return",a);case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function w(e){return C.apply(this,arguments)}function C(){return(C=Object(O.a)(x.a.mark((function e(t){return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t("/api/v1/auth/logout/",{method:"POST"});case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var N="vampire-diary-auth-token";var S=Object(f.b)("auth/login",function(){var e=Object(O.a)(x.a.mark((function e(t,r){var n,a;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=y({"Content-Type":"application/json",Accept:"application/json"}),e.next=3,g(n,t);case 3:return a=e.sent,localStorage.setItem(N,a.key),e.abrupt("return",a);case 6:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}());function A(e){var t=e.getState().auth.token;if(null===t)throw new Error("Must be logged in");return function(e){return y(Object(v.a)(Object(v.a)({},{"Content-Type":"application/json",Accept:"application/json"}),function(e){return{Authorization:"Token ".concat(e)}}(e)))}(t)}var I=Object(f.b)("auth/logout",function(){var e=Object(O.a)(x.a.mark((function e(t,r){var n;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=A(r),e.next=3,w(n);case 3:localStorage.removeItem(N);case 4:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}()),D=Object(f.d)({name:"auth",initialState:{token:localStorage.getItem(N)},reducers:{},extraReducers:function(e){return e.addCase(S.fulfilled,(function(e,t){e.token=t.payload.key})).addCase(I.fulfilled,(function(e,t){e.token=null}))}});function E(e){return null!==e.auth.token}var M=r(0);function F(){var e=u(E),t=l(),r=Object(n.useState)(""),a=Object(o.a)(r,2),c=a[0],i=a[1],s=Object(n.useState)(""),p=Object(o.a)(s,2),x=p[0],O=p[1];return e?Object(M.jsx)(m.a,{to:"/vampires"}):Object(M.jsx)(d.a,{children:Object(M.jsxs)(j.a,{children:[Object(M.jsxs)(b.a,{className:"mt-3",children:[Object(M.jsx)(j.a.Label,{children:"Username"}),Object(M.jsx)(j.a.Control,{placeholder:"Username",onChange:function(e){return i(e.target.value)}})]}),Object(M.jsxs)(b.a,{className:"mt-3",children:[Object(M.jsx)(j.a.Label,{children:"Password"}),Object(M.jsx)(j.a.Control,{type:"password",placeholder:"Password",onChange:function(e){return O(e.target.value)}})]}),Object(M.jsx)(h.a,{variant:"outline-primary",className:"mt-3",onClick:function(){return t(S({username:c,password:x}))},children:"Log In"})]})})}function L(e){var t=e.children;return u(E)?t:Object(M.jsx)(m.a,{to:"/login"})}var R={show:500,hide:0},T=r(123),B=r(122),V=r(90),P=r(124),G=r(126),q=r(119),K=r(120),H=r(33),J=r(32),U=r(31),Y=r(131),z=r(88),_=r(15),Q=r(20);function W(e,t){var r=t.queryApi,n=t.createApi,a=t.retrieveApi,c=t.updateApi,i=t.removeApi;return{query:Object(f.b)("".concat(e,"/query"),(function(e,t){var n=A(t);return r(n,e)})),create:Object(f.b)("".concat(e,"/create"),(function(e,t){var r=A(t);return n(r,e)})),retrieve:Object(f.b)("".concat(e,"/retrieve"),(function(e,t){var r=A(t);return a(r,e)})),update:Object(f.b)("".concat(e,"/update"),(function(e,t){var r=A(t);return c(r,e)})),remove:Object(f.b)("".concat(e,"/remove"),function(){var e=Object(O.a)(x.a.mark((function e(t,r){var n;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=A(r),e.next=3,i(n,t);case 3:return e.abrupt("return",t);case 4:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}())}}var X=r(3);function Z(e,t){var r=null;return void 0!==t&&(r=function(e){var t={},r=!1;if(e.search&&(r=!0,t.search=e.search),e.filter)for(var n=0,a=Object.entries(e.filter);n<a.length;n++){var c=Object(o.a)(a[n],2),i=c[0],s=c[1];r=!0,t[i]=s.toString()}return e.sort&&(r=!0,t.ordering="".concat(e.sort[1]).concat(e.sort[0])),void 0!==e.limit&&(r=!0,t.limit=e.limit.toString()),void 0!==e.offset&&(r=!0,t.offset=e.offset.toString()),r?new URLSearchParams(t):null}(t)),null!==r?"".concat(e,"?").concat(r):e}function $(e){function t(){return(t=Object(O.a)(x.a.mark((function t(r,n){var a,c,i;return x.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=Z(e,n),t.next=3,r(a);case 3:return c=t.sent,t.next=6,c.json();case 6:if(i=t.sent,c.ok){t.next=9;break}throw new Error(i.detail);case 9:return t.abrupt("return",i);case 10:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function r(){return(r=Object(O.a)(x.a.mark((function t(r,n){var a,c;return x.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,r(e,{method:"POST",body:JSON.stringify(n)});case 2:return a=t.sent,t.next=5,a.json();case 5:if(c=t.sent,a.ok){t.next=8;break}throw new Error(c.detail);case 8:return t.abrupt("return",c);case 9:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function n(t){return"".concat(e).concat(t,"/")}function a(){return(a=Object(O.a)(x.a.mark((function e(t,r){var a,c;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t(n(r));case 2:return a=e.sent,e.next=5,a.json();case 5:if(c=e.sent,a.ok){e.next=8;break}throw new Error(c.detail);case 8:return e.abrupt("return",c);case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function c(){return(c=Object(O.a)(x.a.mark((function e(t,r){var a,c,i,s;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=r.id,c=Object(X.a)(r,["id"]),e.next=3,t(n(a),{method:"PATCH",body:JSON.stringify(c)});case 3:return i=e.sent,e.next=6,i.json();case 6:if(s=e.sent,i.ok){e.next=9;break}throw new Error(s.detail);case 9:return e.abrupt("return",s);case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function i(){return(i=Object(O.a)(x.a.mark((function e(t,r){var a,c;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t(n(r),{method:"DELETE"});case 2:if((a=e.sent).ok){e.next=8;break}return e.next=6,a.json();case 6:throw c=e.sent,new Error(c.detail);case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return{queryApi:function(e,r){return t.apply(this,arguments)},createApi:function(e,t){return r.apply(this,arguments)},retrieveApi:function(e,t){return a.apply(this,arguments)},updateApi:function(e,t){return c.apply(this,arguments)},removeApi:function(e,t){return i.apply(this,arguments)}}}function ee(){return(ee=Object(O.a)(x.a.mark((function e(t,r){var n;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t("/api/v1/game/vampires/".concat(r,"/deep/"));case 2:return n=e.sent,e.abrupt("return",n.json());case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function te(e){return"/api/v1/game/".concat(e,"/")}var re=$(te("events")),ne=$(te("memories")),ae=$(te("experiences")),ce=$(te("skills")),ie=$(te("resources")),se=$(te("characters")),oe=$(te("marks")),le=Object(f.b)("diary/retrieveDeepVampire",(function(e,t){return function(e,t){return ee.apply(this,arguments)}(A(t),e)})),ue=W("event",re),de=W("memory",ne),je=W("experience",ae),be=W("skill",ce),he=W("resource",ie),me=W("character",se),pe=W("mark",oe);function xe(e){var t=e.character,r=l(),a=Object(n.useState)(t.isImmortal),c=Object(o.a)(a,2),i=c[0],s=c[1],u=Object(n.useState)(t.description),d=Object(o.a)(u,2),j=d[0],h=d[1];Object(n.useEffect)((function(){s(t.isImmortal)}),[t]);return Object(M.jsx)(Y.a,{className:"mt-3",children:Object(M.jsxs)(Y.a.Body,{children:[Object(M.jsx)(G.a,{placement:"bottom",delay:R,overlay:Object(M.jsx)(q.a,{children:t.isDead?"A dead Character cannot become immortal":"Immortal Characters cannot be removed"}),children:Object(M.jsx)("span",{className:"d-inline-block",children:Object(M.jsxs)(K.a,{type:"checkbox",variant:"outline-secondary",value:"1",checked:i,onClick:function(){var e=!i;r(me.update({id:t.id,isImmortal:e}))},disabled:t.isDead,children:[Object(M.jsx)("i",{className:"bi bi-lock me-2"}),"Immortal"]})})}),Object(M.jsx)(G.a,{placement:"bottom",delay:R,overlay:Object(M.jsx)(q.a,{children:i?"Immortal Characters cannot be removed":"Remove this Character"}),children:Object(M.jsx)("span",{className:"d-inline-block",children:Object(M.jsxs)(K.a,{type:"checkbox",variant:"outline-danger",value:"2",className:"ms-3",disabled:i,checked:t.isDead,onClick:function(){return r(me.update({id:t.id,isDead:!t.isDead}))},children:[Object(M.jsx)("i",{className:"bi bi-x-lg me-2"}),"Dead"]})})}),t.isDead?Object(M.jsx)(Y.a.Text,{className:"text-muted mt-3",children:t.description}):Object(M.jsx)(b.a,{className:"mt-3",children:Object(M.jsx)(z.a,{as:_.DebounceInput,forceNotifyByEnter:!1,debounceTimeout:1e3,placeholder:"Describe the character...",value:j,onChange:function(e){var n=e.target.value;h(n),r(me.update({id:t.id,description:n}))},element:Q.a})})]})})}function Oe(e){var t=e.characters;return Object(M.jsx)(M.Fragment,{children:t.map((function(e){return Object(M.jsx)(xe,{character:e},e.id)}))})}function fe(e){var t=e.vampireId,r=l();return Object(M.jsxs)(Y.a,{children:[Object(M.jsx)(Y.a.Header,{children:"Creation"}),Object(M.jsxs)(Y.a.Body,{children:[Object(M.jsx)(Y.a.Text,{children:"To create your Vampire:"}),Object(M.jsxs)("ol",{children:[Object(M.jsx)("li",{children:"Give your Vampire a name and description"}),Object(M.jsx)("li",{children:"Create a single Memory and Experience that describes your Vampire's history as a mortal"}),Object(M.jsx)("li",{children:"Create at least three mortal Characters"}),Object(M.jsx)("li",{children:"Give your Vampire three Skills that they practiced as a mortal"}),Object(M.jsx)("li",{children:"Give your Vampire three Resources that they acquired as a mortal"}),Object(M.jsx)("li",{children:"Create three Memories, each with one Experience relating to any two Characters, Skills and/or Resources that you have created"}),Object(M.jsx)("li",{children:"Create an immortal Character who gifted or cursed your Vampire with undeath"}),Object(M.jsx)("li",{children:"Create a Mark, a Memory and an Experience relating to how your Vampire was gifted or cursed with undeath"})]}),Object(M.jsx)(Y.a.Text,{children:"Your Vampire should now have three Skills, three Resources, one Mark, at least three mortal Characters, one immortal Character, and five Memories each with one Experience."}),Object(M.jsx)(G.a,{placement:"bottom",delay:R,overlay:Object(M.jsx)(q.a,{children:"Generate the first Prompt"}),children:Object(M.jsxs)(h.a,{variant:"outline-success",onClick:function(){return r(ue.create({vampire:t}))},children:[Object(M.jsx)("i",{className:"bi bi-caret-right me-2"}),"Start"]})})]})]})}var ve=function(e){var t=e.name,r=e.baseUrl,n=Object(f.c)({selectId:function(e){return e.id}}),a=W(t,$(r)),c=a.query,i=a.create,s=a.retrieve,o=a.update,l=a.remove,u=Object(f.d)({name:t,initialState:n.getInitialState(),reducers:{},extraReducers:function(e){return e.addCase(c.fulfilled,(function(e,t){n.setAll(e,t.payload.results)})).addCase(i.fulfilled,(function(e,t){n.addOne(e,t.payload)})).addCase(s.fulfilled,(function(e,t){n.setOne(e,t.payload)})).addCase(o.fulfilled,(function(e,t){n.setOne(e,t.payload)})).addCase(l.fulfilled,(function(e,t){n.removeOne(e,t.payload)}))}});return{adapter:n,query:c,create:i,retrieve:s,update:o,remove:l,slice:u}}({name:"vampire",baseUrl:"/api/v1/game/vampires/"}),ye=ve.adapter,ge=ve.query,ke=ve.create,we=(ve.retrieve,ve.update),Ce=ve.remove,Ne=ve.slice,Se=ye.getSelectors((function(e){return e.vampire})),Ae=Object(f.c)({selectId:function(e){return e.id}}),Ie=Object(f.c)({selectId:function(e){return e.id}}),De=Object(f.c)({selectId:function(e){return e.id}}),Ee=Object(f.c)({selectId:function(e){return e.id}}),Me=Object(f.c)({selectId:function(e){return e.id}}),Fe=Object(f.c)({selectId:function(e){return e.id}}),Le=Object(f.c)({selectId:function(e){return e.id}});function Re(e,t,r,n){return e.addCase(n.create.fulfilled,(function(e,n){var a=t(e);r.addOne(a,n.payload)})).addCase(n.update.fulfilled,(function(e,n){var a=t(e);r.upsertOne(a,n.payload)})).addCase(n.remove.fulfilled,(function(e,n){var a=t(e);r.removeOne(a,n.payload)}))}var Te=Object(f.d)({name:"diary",initialState:{vampire:void 0,currentEventIndex:void 0,showAllMemories:!1,showAllSkills:!1,showAllResources:!1,showDiaryMemories:!1,showAllCharacters:!1,event:Ae.getInitialState(),memory:Ie.getInitialState(),experience:De.getInitialState(),skill:Ee.getInitialState(),resource:Me.getInitialState(),character:Fe.getInitialState(),mark:Le.getInitialState()},reducers:{eventStart:function(e){void 0!==e.currentEventIndex&&(e.currentEventIndex=0)},eventEnd:function(e){void 0!==e.currentEventIndex&&(e.currentEventIndex=e.event.ids.length-1)},eventBack:function(e){void 0!==e.currentEventIndex&&0!==e.currentEventIndex&&e.currentEventIndex--},eventForward:function(e){void 0===e.currentEventIndex||e.currentEventIndex>=e.event.ids.length-1||e.currentEventIndex++},toggleShowAllMemories:function(e){e.showAllMemories=!e.showAllMemories},toggleShowAllSkills:function(e){e.showAllSkills=!e.showAllSkills},toggleShowAllResources:function(e){e.showAllResources=!e.showAllResources},toggleShowDiaryMemories:function(e){e.showDiaryMemories=!e.showDiaryMemories},toggleShowAllCharacters:function(e){e.showAllCharacters=!e.showAllCharacters}},extraReducers:function(e){var t=e.addCase(le.fulfilled,(function(e,t){var r=t.payload;e.vampire={id:r.id,name:r.name,description:r.description,isDead:r.isDead};var n=r.events;if(n.length>0){var a=n.length-1;e.currentEventIndex=a}Ae.setAll(e.event,r.events),Ie.setAll(e.memory,r.memories),De.setAll(e.experience,r.experiences),Ee.setAll(e.skill,r.skills),Me.setAll(e.resource,r.resources),Fe.setAll(e.character,r.characters),Le.setAll(e.mark,r.marks)}));return t=Re(t=(t=(t=(t=t.addCase(we.fulfilled,(function(e,t){e.vampire=t.payload}))).addCase(ue.create.fulfilled,(function(e,t){Ae.addOne(e.event,t.payload);var r=e.event.ids.length-1;e.currentEventIndex=r}))).addCase(ue.update.fulfilled,(function(e,t){Ae.upsertOne(e.event,t.payload)}))).addCase(ue.remove.fulfilled,(function(e,t){Ae.removeOne(e.event,t.payload)})),(function(e){return e.memory}),Ie,de),t=Re(t,(function(e){return e.experience}),De,je),t=Re(t,(function(e){return e.skill}),Ee,be),t=Re(t,(function(e){return e.resource}),Me,he),t=Re(t,(function(e){return e.character}),Fe,me),t=Re(t,(function(e){return e.mark}),Le,pe)}}),Be=Te.actions,Ve=Be.eventStart,Pe=Be.eventEnd,Ge=Be.eventBack,qe=Be.eventForward,Ke=Be.toggleShowAllMemories,He=Be.toggleShowAllSkills,Je=Be.toggleShowAllResources,Ue=Be.toggleShowDiaryMemories,Ye=Be.toggleShowAllCharacters,ze=function(e){return e.diary.vampire},_e=function(e){var t,r;return null!==(t=null===(r=e.diary.vampire)||void 0===r?void 0:r.isDead)&&void 0!==t&&t},Qe=function(e){return 0===lt(e).length&&0===dt(e).length},We=function(e){return 0===e.diary.currentEventIndex},Xe=function(e){return void 0!==e.diary.currentEventIndex&&e.diary.currentEventIndex===e.diary.event.ids.length-1},Ze=function(e){var t=e.diary.currentEventIndex;if(void 0!==t){var r=e.diary.event.ids[t];return e.diary.event.entities[r]}},$e=function(e){var t=e.diary.currentEventIndex;if(void 0!==t&&0!==t){var r=t-1,n=e.diary.event.ids[r];return e.diary.event.entities[n]}},et=(Ae.getSelectors((function(e){return e.diary.event})),Ie.getSelectors((function(e){return e.diary.memory}))),tt=function(e){return e.diary.showAllMemories},rt=function(e){return e.diary.showAllSkills},nt=function(e){return e.diary.showAllResources},at=function(e){return e.diary.showDiaryMemories},ct=function(e){return e.diary.showAllCharacters},it=function(e){var t=et.selectAll(e);return e.diary.showAllMemories?t.filter((function(e){return null===e.diary})):t.filter((function(e){return!e.isForgotten&&null===e.diary}))},st=De.getSelectors((function(e){return e.diary.experience})),ot=Ee.getSelectors((function(e){return e.diary.skill})),lt=function(e){var t=ot.selectAll(e);return e.diary.showAllSkills?t:t.filter((function(e){return!e.isChecked}))},ut=Me.getSelectors((function(e){return e.diary.resource})),dt=function(e){var t=ut.selectAll(e);return e.diary.showAllResources?t:t.filter((function(e){return!e.isLost}))},jt=function(e){var t;return null!==(t=ut.selectAll(e).find((function(e){return e.isDiary&&!e.isLost})))&&void 0!==t?t:null},bt=function(e){var t=jt(e);return null===t?[]:et.selectAll(e).filter((function(e){return e.diary===t.id}))},ht=function(e){return bt(e).length>=4},mt=Fe.getSelectors((function(e){return e.diary.character})),pt=function(e){var t=mt.selectAll(e);return e.diary.showAllCharacters?t:t.filter((function(e){return!e.isDead}))},xt=Le.getSelectors((function(e){return e.diary.mark})),Ot=r(121);function ft(e){var t=e.vampireId,r=e.currentEvent,a=l(),c=u(We),i=u(Xe),s=u(_e),d=u(Qe),j=u($e),m=Object(n.useState)(r.description),p=Object(o.a)(m,2),x=p[0],O=p[1];Object(n.useEffect)((function(){O(r.description)}),[r]);return Object(M.jsxs)(Y.a,{bg:"dark",text:"light",children:[Object(M.jsxs)(Y.a.Header,{children:["Prompt ",r.prompt,r.visit]}),Object(M.jsxs)(Y.a.Body,{children:[Object(M.jsxs)(Ot.a,{className:"mb-3",children:[Object(M.jsxs)(h.a,{variant:"secondary",disabled:!j,onClick:function(){return a(Ge())},children:[Object(M.jsx)("i",{className:"bi bi-caret-left me-2"}),"Previous"]}),Object(M.jsxs)(h.a,{variant:i?"success":"secondary",disabled:i&&s,onClick:function(){a(i?ue.create({vampire:t}):qe())},children:[i?Object(M.jsx)("i",{className:"bi bi-dice-3 me-2"}):Object(M.jsx)("i",{className:"bi bi-caret-right me-2"}),"Next"]})]}),Object(M.jsxs)(Ot.a,{className:"ms-3 mb-3",children:[Object(M.jsxs)(h.a,{variant:"secondary",disabled:c,onClick:function(){return a(Ve())},children:[Object(M.jsx)("i",{className:"bi bi-skip-start me-2"}),"First"]}),Object(M.jsxs)(h.a,{variant:"secondary",disabled:i,onClick:function(){return a(Pe())},children:[Object(M.jsx)("i",{className:"bi bi-skip-end me-2"}),"Last"]})]}),d&&!s?Object(M.jsx)(G.a,{placement:"bottom",delay:R,overlay:Object(M.jsxs)(q.a,{children:[Object(M.jsx)("p",{children:"You die if a Prompt forces you to check a Skill or lose a Resource but you have none."}),Object(M.jsx)("p",{children:"Describe how your Vampire dies and then click this button to end the game."})]}),children:Object(M.jsxs)(h.a,{variant:"danger",className:"ms-3 mb-3",onClick:function(){return a(we({id:t,isDead:!0}))},children:[Object(M.jsx)("i",{className:"bi bi-x-octagon me-2"}),"Dead"]})}):null,Object(M.jsx)(Y.a.Text,{children:null===r||void 0===r?void 0:r.promptDescription}),Object(M.jsx)(b.a,{children:Object(M.jsx)(z.a,{as:_.DebounceInput,forceNotifyByEnter:!1,debounceTimeout:1e3,placeholder:"Describe what happens...",value:x,onChange:function(e){var t=e.target.value;O(t),a(ue.update({id:r.id,description:t}))},element:Q.a})})]})]})}function vt(e){var t=e.mark,r=l(),a=Object(n.useState)(t.description),c=Object(o.a)(a,2),i=c[0],s=c[1];return Object(M.jsx)(b.a,{className:"mt-3",children:Object(M.jsx)(z.a,{as:_.DebounceInput,element:Q.a,forceNotifyByEnter:!1,debounceTimeout:1e3,placeholder:"Describe the mark...",value:i,onChange:function(e){var n=e.target.value;s(n),r(pe.update({id:t.id,description:n}))}})})}function yt(e){var t=e.marks;return Object(M.jsx)(M.Fragment,{children:t.map((function(e){return Object(M.jsx)(vt,{mark:e},e.id)}))})}function gt(e){var t=e.experience,r=l(),a=Object(n.useState)(t.description),c=Object(o.a)(a,2),i=c[0],s=c[1];return Object(M.jsx)(b.a,{className:"mt-3",children:Object(M.jsx)(z.a,{as:_.DebounceInput,forceNotifyByEnter:!1,debounceTimeout:1e3,placeholder:"Describe the experience...",value:i,onChange:function(e){var n=e.target.value;s(n),r(je.update({id:t.id,description:n}))},element:Q.a})})}function kt(e){var t=e.experiences;return Object(M.jsx)(M.Fragment,{children:t.map((function(e,t){return Object(M.jsx)(gt,{experience:e},e.id)}))})}function wt(e){var t=e.memory,r=e.experiences,n=l(),a=u(jt),c=u(ht),i=r.length>=3;return Object(M.jsxs)(Y.a,{className:"mt-3",children:[Object(M.jsx)(Y.a.Header,{children:"Experiences"}),Object(M.jsxs)(Y.a.Body,{children:[null===t.diary?Object(M.jsxs)(M.Fragment,{children:[Object(M.jsx)(G.a,{placement:"bottom",delay:R,overlay:Object(M.jsx)(q.a,{children:t.isForgotten?"Cannot add new Experiences to a forgotten Memory":i?"A Memory can only hold three Experiences":"Add a new Experience"}),children:Object(M.jsx)("span",{className:"d-inline-block",children:Object(M.jsxs)(h.a,{disabled:i||t.isForgotten,variant:"outline-success",onClick:function(){return n(je.create({memory:t.id,description:""}))},children:[Object(M.jsx)("i",{className:"bi bi-plus-lg me-2"}),"Create"]})})}),Object(M.jsx)(G.a,{placement:"bottom",delay:R,overlay:Object(M.jsx)(q.a,{children:"Remove this Memory"}),children:Object(M.jsxs)(K.a,{type:"checkbox",value:"1",className:"ms-3",variant:"outline-danger",checked:t.isForgotten,onClick:function(){return n(de.update({id:t.id,isForgotten:!t.isForgotten}))},children:[Object(M.jsx)("i",{className:"bi bi-x-lg me-2"}),"Forget"]})}),Object(M.jsx)(G.a,{placement:"bottom",delay:R,overlay:Object(M.jsx)(q.a,{children:null===a?"Your Vampire does not have a Diary":c?"A Diary can only hold four Memories":t.isForgotten?"A forgotten Memory cannot be stored in a Diary":"Move this Memory to your Diary"}),children:Object(M.jsx)("span",{className:"d-inline-block",children:Object(M.jsxs)(h.a,{disabled:null===a||c||t.isForgotten,variant:"outline-secondary",className:"ms-3",onClick:function(){return n(de.update({id:t.id,diary:a.id}))},children:[Object(M.jsx)("i",{className:"bi bi-book me-2"}),"Record"]})})})]}):null,t.isForgotten||null!==t.diary?Object(M.jsx)(M.Fragment,{children:r.map((function(e){return Object(M.jsx)(Y.a.Text,{className:"text-muted mt-3",children:e.description},e.id)}))}):Object(M.jsx)(kt,{experiences:r})]})]})}function Ct(e){var t=e.memories,r=e.experiences.reduce((function(e,t){var r=e.get(t.memory);return r?r.push(t):e.set(t.memory,[t]),e}),new Map);return Object(M.jsx)(M.Fragment,{children:t.map((function(e){var t;return Object(M.jsx)(wt,{memory:e,experiences:null!==(t=r.get(e.id))&&void 0!==t?t:[]},e.id)}))})}function Nt(e){var t=e.resource,r=l(),a=Object(n.useState)(t.description),c=Object(o.a)(a,2),i=c[0],s=c[1],d=Object(n.useState)(t.isDiary),j=Object(o.a)(d,2),h=j[0],m=j[1],p=null!==u(jt)&&!h,x=u(at),O=u(bt),f=u(st.selectAll);Object(n.useEffect)((function(){m(t.isDiary)}),[t]);return Object(M.jsx)(Y.a,{className:"mt-3",children:Object(M.jsxs)(Y.a.Body,{children:[Object(M.jsx)(G.a,{placement:"bottom",delay:R,overlay:Object(M.jsx)(q.a,{children:t.isLost?"A lost Resource cannot become a Diary":p?"A Vampire can only hold one Diary":"A Diary can hold up to four Memories"}),children:Object(M.jsx)("span",{className:"d-inline-block",children:Object(M.jsxs)(K.a,{type:"checkbox",variant:"outline-secondary",value:"1",disabled:p||t.isLost,checked:h,onClick:function(){var e=!h;r(he.update({id:t.id,isDiary:e}))},children:[Object(M.jsx)("i",{className:"bi bi-book me-2"}),"Diary"]})})}),Object(M.jsx)(G.a,{placement:"bottom",delay:R,overlay:Object(M.jsx)(q.a,{children:"Remove this Resource"}),children:Object(M.jsxs)(K.a,{type:"checkbox",value:"1",variant:"outline-danger",className:"ms-3",checked:t.isLost,onClick:function(){return r(he.update({id:t.id,isLost:!t.isLost}))},children:[Object(M.jsx)("i",{className:"bi bi-x-lg me-2"}),"Lost"]})}),h&&!t.isLost?Object(M.jsx)(G.a,{placement:"bottom",delay:R,overlay:Object(M.jsx)(q.a,{children:"Show Memories recorded in this Diary"}),children:Object(M.jsxs)(K.a,{type:"checkbox",value:"2",variant:"outline-primary",className:"ms-3",checked:x,onClick:function(){r(Ue())},children:[Object(M.jsx)("i",{className:"bi bi-eye me-2"}),"Show Memories"]})}):null,t.isLost?Object(M.jsx)(Y.a.Text,{className:"text-muted mt-3",children:t.description}):Object(M.jsx)(b.a,{children:Object(M.jsx)(z.a,{className:"mt-3",as:_.DebounceInput,element:Q.a,forceNotifyByEnter:!1,debounceTimeout:1e3,placeholder:"Describe the resource...",value:i,onChange:function(e){var n=e.target.value;s(n),r(he.update({id:t.id,description:n}))}})}),x?Object(M.jsx)(Ct,{memories:O,experiences:f}):null]})})}function St(e){var t=e.resources;return Object(M.jsx)(M.Fragment,{children:t.map((function(e){return Object(M.jsx)(Nt,{resource:e},e.id)}))})}function At(e){var t=e.skill,r=l(),a=Object(n.useState)(t.description),c=Object(o.a)(a,2),i=c[0],s=c[1];return Object(M.jsxs)(B.a,{className:"mt-3",children:[Object(M.jsx)(V.a,{children:t.isChecked?Object(M.jsx)("span",{className:"text-muted",children:t.description}):Object(M.jsx)(b.a,{children:Object(M.jsx)(z.a,{as:_.DebounceInput,element:Q.a,forceNotifyByEnter:!1,debounceTimeout:1e3,placeholder:"Describe the skill...",value:i,onChange:function(e){var n=e.target.value;s(n),r(be.update({id:t.id,description:n}))}})})}),Object(M.jsx)(V.a,{xs:"auto",children:Object(M.jsx)(G.a,{placement:"right",delay:R,overlay:Object(M.jsx)(q.a,{children:"Remove this Skill"}),children:Object(M.jsx)(K.a,{type:"checkbox",value:"1",variant:"outline-danger",checked:t.isChecked,onClick:function(){return r(be.update({id:t.id,isChecked:!t.isChecked}))},children:Object(M.jsx)("i",{className:"bi bi-check-lg"})})})})]})}function It(e){var t=e.skills;return Object(M.jsx)(M.Fragment,{children:t.map((function(e){return Object(M.jsx)(At,{skill:e},e.id)}))})}var Dt=r(89);function Et(e){var t=e.vampire,r=l(),a=Object(n.useState)(t.name),c=Object(o.a)(a,2),i=c[0],s=c[1],u=Object(n.useState)(t.description),d=Object(o.a)(u,2),j=d[0],h=d[1];Object(n.useEffect)((function(){s(t.name),h(t.description)}),[t]);return Object(M.jsxs)(M.Fragment,{children:[Object(M.jsxs)(b.a,{children:[Object(M.jsx)(Dt.a,{children:"Name"}),Object(M.jsx)(z.a,{as:_.DebounceInput,forceNotifyByEnter:!1,debounceTimeout:1e3,placeholder:"Name your vampire...",value:i,onChange:function(e){var n=e.target.value;s(n),r(we({id:t.id,name:n}))}})]}),Object(M.jsxs)(b.a,{className:"mt-3",children:[Object(M.jsx)(Dt.a,{children:"Description"}),Object(M.jsx)(z.a,{as:_.DebounceInput,forceNotifyByEnter:!1,element:Q.a,debounceTimeout:1e3,placeholder:"Describe your vampire...",value:j,onChange:function(e){var n=e.target.value;h(n),r(we({id:t.id,description:n}))}})]})]})}function Mt(){var e=Object(m.h)().id,t=parseInt(e),r=l(),a=u(ze),c=u(Ze),i=u(it),s=i.length>=5,o=u(st.selectAll),j=u(lt),b=u(pt),p=u(dt),x=u(xt.selectAll),O=u(tt),f=u(rt),v=u(nt),y=u(ct);Object(n.useEffect)((function(){r(le(t))}),[t,r]);return a?Object(M.jsx)(d.a,{className:"my-3",fluid:!0,children:Object(M.jsxs)(B.a,{children:[Object(M.jsx)(V.a,{md:!0,className:"mb-3",children:Object(M.jsxs)(P.a,{defaultActiveKey:"vampire",children:[Object(M.jsxs)(U.a,{eventKey:"vampire",children:[Object(M.jsx)(J.a,{children:"Vampire"}),Object(M.jsx)(H.a,{children:Object(M.jsx)(Et,{vampire:a})})]}),Object(M.jsxs)(U.a,{eventKey:"memories",children:[Object(M.jsx)(J.a,{children:"Memories"}),Object(M.jsxs)(H.a,{children:[Object(M.jsx)(G.a,{placement:"right",delay:R,overlay:Object(M.jsx)(q.a,{children:s?"A Vampire can only remember five Memories":"Add a new Memory"}),children:Object(M.jsx)("span",{className:"d-inline-block",children:Object(M.jsxs)(h.a,{disabled:s,variant:"outline-success",onClick:function(){return r(de.create({vampire:t}))},children:[Object(M.jsx)("i",{className:"bi bi-plus-lg me-2"}),"Create"]})})}),Object(M.jsxs)(K.a,{type:"checkbox",value:"1",variant:"outline-primary",className:"ms-3",checked:O,onClick:function(){return r(Ke())},children:[Object(M.jsx)("i",{className:"bi bi-eye  me-2"}),"Show Forgotten"]}),Object(M.jsx)(Ct,{memories:i,experiences:o})]})]}),Object(M.jsxs)(U.a,{eventKey:"skills",children:[Object(M.jsx)(J.a,{children:"Skills"}),Object(M.jsxs)(H.a,{children:[Object(M.jsx)(G.a,{placement:"right",delay:R,overlay:Object(M.jsx)(q.a,{children:"Add a new Skill"}),children:Object(M.jsxs)(h.a,{variant:"outline-success",onClick:function(){return r(be.create({vampire:t,description:""}))},children:[Object(M.jsx)("i",{className:"bi bi-plus-lg me-2"}),"Create"]})}),Object(M.jsxs)(K.a,{type:"checkbox",value:"2",variant:"outline-primary",className:"ms-3",checked:f,onClick:function(){return r(He())},children:[Object(M.jsx)("i",{className:"bi bi-eye me-2"}),"Show Checked"]}),Object(M.jsx)(It,{skills:j})]})]}),Object(M.jsxs)(U.a,{eventKey:"resources",children:[Object(M.jsx)(J.a,{children:"Resources"}),Object(M.jsxs)(H.a,{children:[Object(M.jsx)(G.a,{placement:"right",delay:R,overlay:Object(M.jsx)(q.a,{children:"Add a new Resource"}),children:Object(M.jsxs)(h.a,{variant:"outline-success",onClick:function(){return r(he.create({vampire:t,description:"",isDiary:!1}))},children:[Object(M.jsx)("i",{className:"bi bi-plus-lg me-2"}),"Create"]})}),Object(M.jsxs)(K.a,{type:"checkbox",value:"3",variant:"outline-primary",className:"ms-3",checked:v,onClick:function(){return r(Je())},children:[Object(M.jsx)("i",{className:"bi bi-eye me-2"}),"Show Lost"]}),Object(M.jsx)(St,{resources:p})]})]}),Object(M.jsxs)(U.a,{eventKey:"characters",children:[Object(M.jsx)(J.a,{children:"Characters"}),Object(M.jsxs)(H.a,{children:[Object(M.jsx)(G.a,{placement:"right",delay:R,overlay:Object(M.jsx)(q.a,{children:"Add a new Character"}),children:Object(M.jsxs)(h.a,{variant:"outline-success",onClick:function(){return r(me.create({vampire:t,name:"",description:"",isImmortal:!1}))},children:[Object(M.jsx)("i",{className:"bi bi-plus-lg me-2"}),"Create"]})}),Object(M.jsxs)(K.a,{type:"checkbox",value:"4",variant:"outline-primary",className:"ms-3",checked:y,onClick:function(){return r(Ye())},children:[Object(M.jsx)("i",{className:"bi bi-eye me-2"}),"Show Dead"]}),Object(M.jsx)(Oe,{characters:b})]})]}),Object(M.jsxs)(U.a,{eventKey:"marks",children:[Object(M.jsx)(J.a,{children:"Marks"}),Object(M.jsxs)(H.a,{children:[Object(M.jsx)(G.a,{placement:"right",delay:R,overlay:Object(M.jsx)(q.a,{children:"Add a new Mark"}),children:Object(M.jsxs)(h.a,{variant:"outline-success",onClick:function(){return r(pe.create({vampire:t,description:""}))},children:[Object(M.jsx)("i",{className:"bi bi-plus-lg me-2"}),"Create"]})}),Object(M.jsx)(yt,{marks:x})]})]})]})}),Object(M.jsx)(V.a,{md:!0,children:c?Object(M.jsx)(ft,{vampireId:t,currentEvent:c}):Object(M.jsx)(fe,{vampireId:t})})]})}):Object(M.jsx)(T.a,{animation:"border"})}var Ft=r(46),Lt=r(130),Rt="/api/v1/game/prompt-groups/";function Tt(){return(Tt=Object(O.a)(x.a.mark((function e(t,r){var n,a;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=Z(Rt,r),e.next=3,t(n);case 3:return a=e.sent,e.abrupt("return",a.json());case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Bt=Object(f.c)({selectId:function(e){return e.id},sortComparer:function(e,t){return e.id-t.id}}),Vt=Object(f.b)("promptGroup/queryPromptGroups",(function(e,t){return function(e,t){return Tt.apply(this,arguments)}(A(t),e)})),Pt=Object(f.d)({name:"promptGroup",initialState:Bt.getInitialState(),reducers:{},extraReducers:function(e){return e.addCase(Vt.fulfilled,(function(e,t){Bt.setAll(e,t.payload.results)}))}}),Gt=Bt.getSelectors((function(e){return e.promptGroup})),qt=r(91);function Kt(e){var t=e.onCancel,r=e.onSubmit,a=l(),c=u(Gt.selectAll),i=Object(n.useState)(null),s=Object(o.a)(i,2),j=s[0],m=s[1],p=Object(n.useState)(null),x=Object(o.a)(p,2),O=x[0],f=x[1];return Object(n.useEffect)((function(){a(Vt())}),[a]),Object(M.jsxs)(d.a,{className:"py-3",children:[Object(M.jsx)("h2",{children:"Create Vampire"}),Object(M.jsxs)(b.a,{children:[Object(M.jsx)(Dt.a,{children:"Name"}),Object(M.jsx)(z.a,{placeholder:"Enter a name...",onChange:function(e){return m(e.target.value)}})]}),Object(M.jsxs)(b.a,{className:"mt-3",children:[Object(M.jsx)(Dt.a,{children:"Prompt Group"}),Object(M.jsxs)(qt.a,{onChange:function(e){var t=null;""!==e.target.value&&(t=parseInt(e.target.value)),f(t)},children:[Object(M.jsx)("option",{value:"",children:"Select a prompt group..."}),c.map((function(e){return Object(M.jsx)("option",{value:e.id,children:e.name},e.id)}))]})]}),Object(M.jsx)(G.a,{placement:"bottom",delay:R,overlay:Object(M.jsx)(q.a,{children:"Discard changes"}),children:Object(M.jsxs)(h.a,{variant:"outline-danger",className:"mt-3",onClick:t,children:[Object(M.jsx)("i",{className:"bi bi-x-lg me-2"}),"Cancel"]})}),Object(M.jsx)(G.a,{placement:"bottom",delay:R,overlay:Object(M.jsx)(q.a,{children:"Go to the Diary page"}),children:Object(M.jsxs)(h.a,{variant:"outline-success",className:"mt-3 ms-3",disabled:!(j&&null!==O),onClick:function(){r&&r({name:j,description:"",promptGroup:O})},children:[Object(M.jsx)("i",{className:"bi bi-plus-lg me-2"}),"Create"]})})]})}r(110);var Ht=r(125);function Jt(){var e=l(),t=u(Se.selectAll),r=Object(m.g)();Object(n.useEffect)((function(){e(ge({sort:["created_at","-"]}))}),[e]);return Object(M.jsxs)(Ht.a,{hover:!0,children:[Object(M.jsx)("thead",{children:Object(M.jsxs)("tr",{children:[Object(M.jsx)("th",{children:"Name"}),Object(M.jsx)("th",{children:"Description"}),Object(M.jsx)("th",{children:"Game Over"}),Object(M.jsx)("th",{children:"Actions"})]})}),Object(M.jsx)("tbody",{children:t.map((function(t){return Object(M.jsxs)("tr",{className:"vampire-list-item",onClick:function(){return r("/vampires/".concat(t.id))},children:[Object(M.jsx)("td",{children:t.name}),Object(M.jsx)("td",{children:t.description}),Object(M.jsx)("td",{children:t.isDead?"Yes":"No"}),Object(M.jsx)("td",{children:Object(M.jsxs)(h.a,{variant:"outline-danger",onClick:function(r){return function(t,r){t.stopPropagation(),e(Ce(r))}(r,t.id)},children:[Object(M.jsx)("i",{className:"bi bi-x-lg me-2"}),"Delete"]})})]},t.id)}))})]})}function Ut(){var e=l(),t=Object(m.g)(),r=Object(n.useState)(!1),a=Object(o.a)(r,2),c=a[0],i=a[1],s=function(){return i(!1)},u=function(){var r=Object(O.a)(x.a.mark((function r(n){var a;return x.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,e(ke(n)).unwrap();case 2:a=r.sent,s(),t("/vampires/".concat(a.id));case 5:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}();return Object(M.jsxs)(d.a,{className:"mt-3",fluid:!0,children:[Object(M.jsx)(G.a,{placement:"bottom",delay:R,overlay:Object(M.jsx)(q.a,{children:"Create a new Vampire"}),children:Object(M.jsxs)(h.a,{variant:"outline-success",className:"mb-3",onClick:function(){return i(!0)},children:[Object(M.jsx)("i",{className:"bi bi-plus-lg me-2"}),"Create"]})}),Object(M.jsx)(Jt,{}),Object(M.jsx)(Lt.a,{show:c,onHide:s,children:Object(M.jsx)(Kt,{onCancel:s,onSubmit:u})})]})}var Yt=r(128),zt=r(127);function _t(){var e=u(E),t=l();return Object(M.jsx)(Yt.a,{bg:"dark",variant:"dark",expand:"lg",fixed:"top",children:Object(M.jsxs)(d.a,{fluid:!0,children:[Object(M.jsx)(Yt.a.Brand,{href:"/",children:"Vampire Diary"}),Object(M.jsx)(Yt.a.Toggle,{}),Object(M.jsxs)(Yt.a.Collapse,{children:[Object(M.jsx)(zt.a,{children:e?Object(M.jsx)(zt.a.Link,{as:Ft.b,to:"/vampires",children:"Vampires"}):null}),Object(M.jsx)(zt.a,{className:"ms-auto",children:e?Object(M.jsxs)(M.Fragment,{children:[Object(M.jsx)(zt.a.Link,{as:Ft.b,to:"/settings",children:"Account"}),Object(M.jsx)(zt.a.Link,{href:"#",onClick:function(){return t(I())},children:"Logout"})]}):Object(M.jsxs)(M.Fragment,{children:[Object(M.jsx)(zt.a.Link,{as:Ft.b,to:"/register",children:"Register"}),Object(M.jsx)(zt.a.Link,{as:Ft.b,to:"/login",children:"Login"})," "]})})]})]})})}function Qt(){var e=u(E);return Object(M.jsx)(M.Fragment,{children:Object(M.jsxs)(Ft.a,{children:[Object(M.jsx)(_t,{}),Object(M.jsxs)(m.d,{children:[Object(M.jsx)(m.b,{path:"/vampires/:id",element:Object(M.jsx)(L,{children:Object(M.jsx)(Mt,{})})}),Object(M.jsx)(m.b,{path:"/vampires",element:Object(M.jsx)(L,{children:Object(M.jsx)(Ut,{})})}),Object(M.jsx)(m.b,{path:"/settings"}),Object(M.jsx)(m.b,{path:"/login",element:Object(M.jsx)(F,{})}),Object(M.jsx)(m.b,{path:"*",element:Object(M.jsx)(m.a,{to:e?"/vampires":"/login"})})]})]})})}var Wt=function(e){e&&e instanceof Function&&r.e(3).then(r.bind(null,132)).then((function(t){var r=t.getCLS,n=t.getFID,a=t.getFCP,c=t.getLCP,i=t.getTTFB;r(e),n(e),a(e),c(e),i(e)}))},Xt=Object(f.a)({reducer:{auth:D.reducer,promptGroup:Pt.reducer,vampire:Ne.reducer,diary:Te.reducer}});i.a.render(Object(M.jsx)(a.a.StrictMode,{children:Object(M.jsx)(s.a,{store:Xt,children:Object(M.jsx)(Qt,{})})}),document.getElementById("root")),Wt()},96:function(e,t,r){}},[[113,1,2]]]);
//# sourceMappingURL=main.7cd2aa40.chunk.js.map